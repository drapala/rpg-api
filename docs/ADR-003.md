# ADR-003: REST API Design and Response Structure

## Status
Accepted

## Context
The assignment requires exposing character management and battle features via HTTP endpoints.
Although the scope is small, the API should follow RESTful principles and provide a clear, consistent developer experience.
Future extensions (databases, authentication, real-time features) should be possible without breaking API contracts.

## Decision
Adopt a **RESTful API design** with the following conventions:
- **Resource-oriented endpoints** with plural nouns:
  - `POST   /api/characters` → create a character
  - `GET    /api/characters` → list characters
  - `GET    /api/characters/{id}` → get character details
  - `POST   /api/battles` → start a battle
- **DTOs** define input/output contracts, decoupled from domain models.
- **Consistent response envelope**:

```js
// Success
{
"data": {},
"timestamp": "2025-09-21T12:00:00Z"
}

// Error
{
"error": { "code": "VALIDATION_ERROR", "message": "Invalid character name" },
"timestamp": "2025-09-21T12:00:00Z"
}
```

### HTTP status codes
- `201 Created` – Character successfully created
- `200 OK` – Successful retrieval/battle outcome
- `404 Not Found` – Character not found
- `422 Unprocessable Entity` – Validation error
- `409 Conflict` – Invalid state (e.g., dead character in battle)

### Alternatives Considered
- **GraphQL**: Flexible, but overkill for this scope; adds unnecessary complexity.
- **RPC-style endpoints** (`/createCharacter`, `/startBattle`): Simple, but not RESTful and harder to extend.
- **Flat JSON without envelope**: Less verbose, but inconsistent error handling.

### Consequences
- ✅ Clear, predictable API structure
- ✅ Easier client integration and testing
- ✅ Aligned with REST best practices
- ⚠️ Slightly more verbose responses (envelope adds JSON depth)
- ⚠️ Limited flexibility compared to GraphQL (acceptable for this assignment)

### Notes
This ADR ensures that even with a small in-memory implementation, the API looks and feels production-ready.  
It complements ADR-001 (tech stack) and ADR-002 (battle design).
